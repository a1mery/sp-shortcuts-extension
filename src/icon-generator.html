<!DOCTYPE html>
<html>
<head>
    <title>Icon Generator</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .icon-preview { margin: 20px 0; }
        canvas { border: 1px solid #ccc; margin: 10px; }
        button { padding: 10px 20px; margin: 5px; background: #0078d4; color: white; border: none; border-radius: 4px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>SharePoint Shortcuts Icon Generator</h1>
    <p>This tool converts the SVG icon to different PNG sizes required by Chrome extensions.</p>
    
    <div class="icon-preview">
        <h3>SVG Source:</h3>
        <div id="svg-container"></div>
    </div>
    
    <div>
        <h3>Generated Icons:</h3>
        <canvas id="canvas16" width="16" height="16"></canvas>
        <canvas id="canvas32" width="32" height="32"></canvas>
        <canvas id="canvas48" width="48" height="48"></canvas>
        <canvas id="canvas128" width="128" height="128"></canvas>
    </div>
    
    <div>
        <button onclick="generateIcons()">Generate Icons</button>
        <button onclick="downloadIcon(16)">Download 16x16</button>
        <button onclick="downloadIcon(32)">Download 32x32</button>
        <button onclick="downloadIcon(48)">Download 48x48</button>
        <button onclick="downloadIcon(128)">Download 128x128</button>
    </div>

    <script>
        const svgSource = `<svg width="128" height="128" viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg">
          <rect width="128" height="128" rx="16" fill="#0078d4"/>
          <text x="64" y="45" font-family="Segoe UI, Arial, sans-serif" font-size="36" font-weight="bold" 
                text-anchor="middle" fill="white">SP</text>
          <g fill="white" opacity="0.9">
            <path d="M25 75 L35 70 L35 73 L45 73 L45 77 L35 77 L35 80 Z"/>
            <path d="M55 85 L65 80 L65 83 L75 83 L75 87 L65 87 L65 90 Z"/>
            <path d="M85 75 L95 70 L95 73 L105 73 L105 77 L95 77 L95 80 Z"/>
          </g>
          <g fill="white" opacity="0.7">
            <circle cx="25" cy="95" r="2"/>
            <circle cx="35" cy="95" r="2"/>
            <circle cx="45" cy="95" r="2"/>
            <circle cx="55" cy="105" r="2"/>
            <circle cx="65" cy="105" r="2"/>
            <circle cx="75" cy="105" r="2"/>
            <circle cx="85" cy="95" r="2"/>
            <circle cx="95" cy="95" r="2"/>
            <circle cx="105" cy="95" r="2"/>
          </g>
        </svg>`;

        document.getElementById('svg-container').innerHTML = svgSource;

        function generateIcons() {
            const sizes = [16, 32, 48, 128];
            
            sizes.forEach(size => {
                const canvas = document.getElementById(`canvas${size}`);
                const ctx = canvas.getContext('2d');
                
                const img = new Image();
                const svgBlob = new Blob([svgSource], {type: 'image/svg+xml'});
                const url = URL.createObjectURL(svgBlob);
                
                img.onload = function() {
                    ctx.drawImage(img, 0, 0, size, size);
                    URL.revokeObjectURL(url);
                };
                
                img.src = url;
            });
        }

        function downloadIcon(size) {
            const canvas = document.getElementById(`canvas${size}`);
            const link = document.createElement('a');
            link.download = `icon${size}.png`;
            link.href = canvas.toDataURL();
            link.click();
        }

        // Auto-generate on page load
        window.onload = () => {
            setTimeout(generateIcons, 100);
        };
    </script>
</body>
</html>
